<!DOCTYPE html>
<html lang="ko">
<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>가위바위보</title>
	<style>
		#computer {
			width: 163px;
			height: 200px;
			background: url('./rsp.png') 0 0 / auto 200px no-repeat;
		}
	</style>
</head>
<body>
	<div id="computer"></div>
	<div>		
		<button id="scissors" class="btn">가위</button>
		<button id="rock" class="btn">바위</button>
		<button id="paper" class="btn">보</button>
	</div>
	<div id="score">0</div>
	<script>
		'use strict';

		const $computer = document.querySelector('#computer');
		const $score = document.querySelector('#score');
		const $rock = document.querySelector('#rock');
		const $scissors = document.querySelector('#scissors');
		const $paper = document.querySelector('#paper');

		const rspX = {
			scissors: '0',
			rock: '-228px',
			paper: '-442px',
		};

		let computerChoice = 'scissors';
		const changeComputerHand = () => {
			if (computerChoice === 'scissors') {
				computerChoice = 'rock';
			} else if (computerChoice === 'rock') {
				computerChoice = 'paper';
			} else if (computerChoice === 'paper') {
				computerChoice = 'scissors';
			}
			$computer.style.backgroundPosition = `${rspX[computerChoice]} 0`;
		};

		let intervalId = setInterval(changeComputerHand, 50);

		const scoreTable = {
			rock: 0,
			scissors: 1,
			paper: -1,
		};

		let clickable = true; // 스위치
		let score = 0;

		const clickButton = (e) => {

			if(clickable) {

				clearInterval(intervalId);
				clickable = false;

				const myChoice = e.target.id; // 내가 고른 가위바위보 종류

				const myScore = scoreTable[myChoice]; // 나의 가위바위보 종류 점수
				const computerScore = scoreTable[computerChoice]; // 컴퓨터의 가위바위보 종류 점수
				const diff = myScore - computerScore; // 결과 종류 점수

				let message = undefined;

				/* 코딩 꿀팁 Tip */
				/* if ( variable === '고양이' || variable === '사자' || variable === '호랑이' || variable === '토끼' ) 를 간단하게 하면
				/* if ( ['고양이', '사자', '호랑이', '토끼'].includes(variable) ) 로 간단하게 표현 가능하다.
				/* //코딩 꿀팁 Tip */

				// 승리 조건   : 2, -1
				// 패배 조건 	 : -2, 1
				// 무승부 조건 : 0 
				switch(diff) {
					case 2:
					case -1: message = '승리'; score += 1;
						break;
					case -2:
					case 1: message = '패배'; score -= 1;
						break;
					case 0:	message = '무승부';
						break;
					default: throw Error('에러 발생');
						break;
				}

				$score.textContent = `${message} 총: ${score}점`;

				setTimeout(() => {

					clickable = true;
					intervalId = setInterval(changeComputerHand, 50);
	
				}, 1000);

			}

		};

		$rock.addEventListener('click', clickButton);
		$scissors.addEventListener('click', clickButton);
		$paper.addEventListener('click', clickButton);

	</script>
</body>
</html>